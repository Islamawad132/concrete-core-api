# المركز القومي لبحوث الاسكان والبناء
## معهد بحوث مواد البناء و ضبط الجودة

### Housing and Building National Research Center (HBRC)
### Building Materials Research & Quality Control Institute

---

# API اختبارات الخرسانة

واجهة برمجية لحساب اختبارات الخرسانة المتصلدة وفقاً للمواصفات المصرية والبريطانية.

## التشغيل

```bash
npm install
npm run build
npm start
```

**Swagger UI**: http://localhost:3000/api-docs

---

# الاختبارات المتاحة

| الاختبار | المواصفة | الـ Endpoint |
|----------|----------|--------------|
| اختبار القلب الخرساني | ECP 203-2020 | `POST /api/calculate/batch` |
| اختبار الإقتلاع (تماسك طبقتين) | BS 1881-207 | `POST /api/pulloff/calculate/batch` |
| اختبار مطرقة الإرتداد (Schmidt) | EN 12504-2-2021 | `POST /api/schmidt/calculate/batch` |

---

# 1. اختبار القلب الخرساني (Concrete Core Test)

اختبار مقاومة الضغط للخرسانة المتصلدة عن طريق استخراج عينات أسطوانية من المنشأ.

## المعادلة الأساسية

```
مقاومة المكعب المستنبطة = مقاومة القلب × Fm × Fg × (معامل_اتجاه / (1.5 + D/L)) × معامل التسليح
```

## المدخلات المطلوبة

| الحقل | الوصف | مطلوب | مثال |
|-------|-------|-------|------|
| `diameters` | قطر العينة (قياسين متعامدين) مم | ✅ | `[93, 93]` |
| `lengths` | طول العينة (2-3 قياسات) مم | ✅ | `[121, 121, 121]` |
| `breakingLoadKN` | حمل الكسر (كيلو نيوتن) | ✅ | `142.32` |
| `aggregateCondition` | حالة رطوبة القلب | ✅ | `"dry"` / `"natural"` / `"saturated"` |
| `directionFactor` | معامل اتجاه أخذ العينة | ✅ | `2.5` (أفقي) / `2.3` (رأسي) |
| `weightGrams` | الوزن بالجرام (اختياري) | ❌ | `1835` |
| `reinforcement` | حديد التسليح (اختياري) | ❌ | `[{"diameterMm": 8, "distanceFromEndMm": 43}]` |

## معاملات التصحيح

| المعامل | الوصف | القيمة |
|---------|-------|--------|
| **Fm** (جافة) | معامل الرطوبة | 0.96 |
| **Fm** (طبيعية) | معامل الرطوبة | 1.00 |
| **Fm** (مشبعة) | معامل الرطوبة | 1.05 |
| **Fg** | معامل القطع | محسوب تلقائياً من الجدول |
| **معامل اتجاه** | اتجاه أخذ العينة | 2.5 (أفقي) / 2.3 (رأسي) |

## مثال عملي - بردورات قلب خرساني

```bash
curl -X POST http://localhost:3000/api/calculate/batch \
  -H "Content-Type: application/json" \
  -d '{
    "samples": [
      {
        "diameters": [93, 93],
        "lengths": [121, 121, 121],
        "breakingLoadKN": 142.32,
        "aggregateCondition": "saturated",
        "directionFactor": 2.5
      },
      {
        "diameters": [93, 93],
        "lengths": [122, 122, 122],
        "breakingLoadKN": 114.78,
        "aggregateCondition": "saturated",
        "directionFactor": 2.5
      },
      {
        "diameters": [93, 93],
        "lengths": [135, 135, 135],
        "breakingLoadKN": 88.25,
        "aggregateCondition": "saturated",
        "directionFactor": 2.5
      }
    ]
  }'
```

### النتيجة (مطابقة لـ Excel):

| العينة | مقاومة القلب | المقاومة المستنبطة |
|--------|--------------|-------------------|
| 1 | 209.51 kg/cm² | **265.74 kg/cm²** |
| 2 | 168.97 kg/cm² | **218.09 kg/cm²** |
| 3 | 129.91 kg/cm² | **174.49 kg/cm²** |

## المخرجات

| الحقل | الوصف | الوحدة |
|-------|-------|--------|
| `coreStrength` | مقاومة الضغط للقلب | كجم/سم² |
| `moistureCorrectionFactor` | معامل Fm | - |
| `cuttingCorrectionFactor` | معامل Fg | - |
| `equivalentCubeStrength` | **المقاومة المستنبطة للمكعب** | كجم/سم² |
| `equivalentCubeStrengthMPa` | المقاومة المستنبطة | MPa |
| `averageStrength` | متوسط المقاومة (للمجموعة) | كجم/سم² |
| `standardDeviation` | الانحراف المعياري | كجم/سم² |

---

# 2. اختبار الإقتلاع (Pull-Off Test)

اختبار قوة التماسك بين طبقتين من الخرسانة أو بين طبقة خرسانية ومادة لاصقة.

## فكرة الاختبار

```
    ↑↑↑ قوة السحب
    ═══════
    ║     ║  ← القرص المعدني (قطر معروف)
    ╠═════╣
    ░░░░░░░  ← الطبقة العلوية
    ▓▓▓▓▓▓▓  ← الطبقة السفلية (البلاطة الخرسانية)
```

## المعادلة الأساسية

```
                        حمل الإنهيار (نيوتن)
إجهاد التماسك (MPa) = ─────────────────────
                        مساحة القرص (مم²)

المساحة = π × (القطر ÷ 2)²
```

## المدخلات المطلوبة

| الحقل | الوصف | مطلوب | مثال |
|-------|-------|-------|------|
| `diameterMm` | قطر العينة (مم) | ✅ | `55` |
| `failureLoadKN` | حمل الإنهيار (كيلو نيوتن) | ✅ | `3.63` |
| `specimenNumber` | رقم العينة | ❌ | `1` |
| `specimenCode` | كود العينة | ❌ | `"MTL/IT/2024/37"` |
| `testedItem` | العنصر المختبر | ❌ | `"بلاطة خرسانية"` |
| `failureMode` | مكان الإنهيار | ❌ | `"حدث الإنفصال في البلاطة"` |

## أنواع الإنهيار

| النوع | التفسير |
|-------|---------|
| حدث الإنفصال في البلاطة الخرسانية | التماسك قوي، الخرسانة أضعف |
| حدث الإنفصال في المادة اللاصقة | المادة اللاصقة أضعف من الخرسانة |
| حدث الإنفصال في السطح البيني | التماسك بين الطبقتين ضعيف |

## مثال عملي

```bash
curl -X POST http://localhost:3000/api/pulloff/calculate/batch \
  -H "Content-Type: application/json" \
  -d '{
    "specimens": [
      {"diameterMm": 55, "failureLoadKN": 3.63},
      {"diameterMm": 55, "failureLoadKN": 2.87},
      {"diameterMm": 49.5, "failureLoadKN": 3.25},
      {"diameterMm": 55, "failureLoadKN": 3.31},
      {"diameterMm": 55, "failureLoadKN": 4.08},
      {"diameterMm": 55, "failureLoadKN": 4.59}
    ]
  }'
```

### النتيجة (مطابقة لـ Excel):

| العينة | القطر (مم) | الحمل (kN) | إجهاد التماسك (MPa) |
|--------|------------|------------|---------------------|
| 1 | 55 | 3.63 | 1.528 |
| 2 | 55 | 2.87 | 1.208 |
| 3 | 49.5 | 3.25 | 1.689 |
| 4 | 55 | 3.31 | 1.393 |
| 5 | 55 | 4.08 | 1.717 |
| 6 | 55 | 4.59 | 1.932 |

### الإحصائيات:

| البيان | القيمة |
|--------|--------|
| المتوسط | 1.578 MPa |
| أقل قيمة | 1.208 MPa |
| أعلى قيمة | 1.932 MPa |
| معامل الاختلاف | **17.23%** |
| اللايقين الموسع | **± 0.352 MPa** |

## المخرجات

| الحقل | الوصف | الوحدة |
|-------|-------|--------|
| `tensileStrengthMPa` | إجهاد التماسك | MPa |
| `areaMm2` | مساحة القرص | مم² |
| `averageStrength` | متوسط الإجهاد | MPa |
| `standardDeviation` | الانحراف المعياري | MPa |
| `coefficientOfVariation` | معامل الاختلاف | % |
| `expandedUncertaintyMPa` | اللايقين الموسع (k=2) | MPa |

---

# 3. اختبار مطرقة الإرتداد (Schmidt Hammer Test)

اختبار غير إتلافي لتقدير صلادة سطح الخرسانة باستخدام مطرقة Schmidt (مطرقة الإرتداد).

## فكرة الاختبار

```
    ╔═══════════╗
    ║  مطرقة   ║ ← Schmidt Hammer
    ║ Schmidt  ║
    ╠═══════════╣
    ║    ↓↑    ║ ← قراءة الإرتداد (Rebound Number)
    ╚═══════════╝
    ▓▓▓▓▓▓▓▓▓▓▓▓▓ ← سطح الخرسانة
```

## المعادلات الأساسية

```
معامل تصحيح السندان (RSA) = 80 ÷ الوسيط(قراءات السندان)

القراءة المصححة = القراءة الأصلية × RSA

النطاق الصالح = 0.75 × الوسيط  إلى  1.25 × الوسيط
```

## حساب اللايقين (Uncertainty)

```
عدم اليقين المتكرر (Repeatability) = √(SD² / n)
عدم اليقين الدقة (Resolution) = 1 / √3
عدم اليقين المعايرة (Calibration) = 0.0266 / 2

عدم اليقين المركب = √(Repeatability² + Resolution² + Calibration²)
عدم اليقين الموسع = k × عدم اليقين المركب    (k = 2 عند 95% ثقة)
```

## المدخلات المطلوبة

### بيانات العناصر (elements)

| الحقل | الوصف | مطلوب | مثال |
|-------|-------|-------|------|
| `elementName` | اسم العنصر | ❌ | `"عمود C1"` |
| `elementCode` | كود العنصر | ❌ | `"COL-01"` |
| `hammerDirection` | اتجاه المطرقة | ❌ | `"horizontal"` / `"up"` / `"down"` |
| `readings` | 15 قراءة إرتداد | ✅ | `[42, 44, 40, ...]` |
| `notes` | ملاحظات | ❌ | `"سطح جاف"` |

### بيانات معايرة السندان (anvilCalibration)

| الحقل | الوصف | مطلوب | مثال |
|-------|-------|-------|------|
| `readingsBefore` | قراءات قبل الاختبار | ✅ | `[82, 83, 82, 82, 83]` |
| `readingsAfter` | قراءات بعد الاختبار | ✅ | `[82, 83, 82, 83, 82]` |

### بيانات إضافية (اختيارية)

| الحقل | الوصف | مثال |
|-------|-------|------|
| `hammerCode` | رقم/كود المطرقة | `"N-34"` |
| `client` | اسم العميل | `"شركة المقاولات"` |
| `project` | اسم المشروع | `"برج السلام"` |
| `testingDate` | تاريخ الاختبار | `"2024-01-15"` |
| `ambientTemperature` | درجة الحرارة | `"25°C"` |

## مثال عملي

```bash
curl -X POST http://localhost:3000/api/schmidt/calculate/batch \
  -H "Content-Type: application/json" \
  -d '{
    "elements": [
      {
        "elementName": "عمود C1",
        "elementCode": "COL-01",
        "hammerDirection": "horizontal",
        "readings": [42, 44, 40, 38, 42, 44, 40, 38, 42, 44, 40, 38, 41, 43, 39]
      },
      {
        "elementName": "كمرة B1",
        "elementCode": "BEAM-01",
        "hammerDirection": "up",
        "readings": [38, 40, 36, 34, 38, 40, 36, 34, 38, 40, 36, 34, 37, 39, 35]
      }
    ],
    "anvilCalibration": {
      "readingsBefore": [82, 83, 82, 82, 83],
      "readingsAfter": [82, 83, 82, 83, 82]
    },
    "hammerCode": "N-34",
    "client": "شركة المقاولات العامة",
    "project": "برج السلام",
    "testingDate": "2024-01-15"
  }'
```

### النتيجة:

| العنصر | الوسيط | RSA | القراءات الصالحة | اللايقين الموسع |
|--------|--------|-----|-----------------|-----------------|
| عمود C1 | 41 | 0.97 | 15/15 | ± 1.28 |
| كمرة B1 | 37 | 0.97 | 15/15 | ± 1.18 |

## المخرجات

### لكل عنصر (ElementResult)

| الحقل | الوصف | الوحدة |
|-------|-------|--------|
| `originalReadings` | القراءات الأصلية | - |
| `correctedReadings` | القراءات المصححة | - |
| `medianRebound` | الوسيط | - |
| `lowerLimit` | الحد الأدنى (0.75 × الوسيط) | - |
| `upperLimit` | الحد الأعلى (1.25 × الوسيط) | - |
| `validReadingsCount` | عدد القراءات الصالحة | - |
| `standardDeviation` | الانحراف المعياري | - |
| `expandedUncertainty` | **اللايقين الموسع** | ± |

### للمجموعة (BatchResult)

| الحقل | الوصف |
|-------|-------|
| `correctionFactorRSA` | معامل تصحيح السندان |
| `anvilMedian` | وسيط قراءات السندان |
| `results` | نتائج جميع العناصر |

---

# المواصفات المرجعية

| الاختبار | المواصفة |
|----------|----------|
| اختبار القلب الخرساني | ECP 203-2020 (الكود المصري) |
| اختبار القلب الخرساني | BS EN 12504-1 |
| اختبار القلب الخرساني | ASTM C42 |
| اختبار الإقتلاع | BS 1881-Part 207-1992 |
| اختبار مطرقة الإرتداد | EN 12504-2-2021 |

---

# الوحدات المستخدمة

| الخاصية | الوحدة | Property | Unit |
|---------|--------|----------|------|
| القطر | مم | Diameter | mm |
| الطول | مم | Length | mm |
| حمل الكسر | كيلو نيوتن | Breaking Load | kN |
| الكثافة | جم/سم³ | Density | g/cm³ |
| المقاومة | كجم/سم² | Strength | kg/cm² |
| المقاومة | ميجا باسكال | Strength | MPa |

---

# ملخص الـ Endpoints

| Endpoint | Method | الوصف |
|----------|--------|-------|
| `/api/calculate/batch` | POST | حساب مجموعة عينات قلب خرساني |
| `/api/pulloff/calculate/batch` | POST | حساب مجموعة عينات إقتلاع |
| `/api/schmidt/calculate/batch` | POST | حساب اختبار مطرقة الإرتداد |
| `/api/health` | GET | فحص حالة الخادم |
| `/api-docs` | GET | توثيق Swagger التفاعلي |

---

# للمزيد من المعلومات

افتح متصفح الويب على: `http://localhost:3000/api-docs`

ستجد توثيق Swagger الكامل مع أمثلة تفاعلية لجميع الاختبارات.
